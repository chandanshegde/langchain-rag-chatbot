graph TD
    %% Define Styles
    classDef frontend fill:#3b82f6,stroke:#1d4ed8,stroke-width:2px,color:#fff
    classDef orchestrator fill:#f43f5e,stroke:#be123c,stroke-width:2px,color:#fff
    classDef backend fill:#10b981,stroke:#047857,stroke-width:2px,color:#fff
    classDef db fill:#f59e0b,stroke:#b45309,stroke-width:2px,color:#fff
    classDef llm fill:#8b5cf6,stroke:#5b21b6,stroke-width:2px,color:#fff

    %% Nodes
    User(("User ðŸ§‘â€ðŸ’»"))
    UI["Frontend (Svelte) ðŸ’»"]:::frontend

    subgraph "Centralized SaaS Platform"
        Orchestrator["Central Orchestrator (SSE Streaming) ðŸ”¥"]:::orchestrator
        Gemini["Google Gemini Model âœ¨"]:::llm
        Redis[("Redis (Session Cache) âš¡")]:::db
    end

    subgraph "Tenant A Data Silo"
        MCP_A["Tenant A MCP Server ðŸ› ï¸"]:::backend
        DB_A[("Tenant A SQLite ðŸ—„ï¸")]:::db
        Chroma_A[("Tenant A ChromaDB ðŸ“Š")]:::db
    end

    subgraph "Tenant B Data Silo"
        MCP_B["Tenant B MCP Server ðŸ› ï¸"]:::backend
        DB_B[("Tenant B SQLite ðŸ—„ï¸")]:::db
        Chroma_B[("Tenant B ChromaDB ðŸ“Š")]:::db
    end

    %% Connections
    User -- "Natural Language Query" --> UI
    UI -- "POST /chat (Streaming SSE)" --> Orchestrator

    Orchestrator -- "Fetch/Save history" --> Redis
    Orchestrator -- "Real-time Callbacks" --> Gemini
    Gemini -- "yield Thought/Action" --> Orchestrator

    %% Multi-Tenant Routing (Addendum)
    Orchestrator -- "tools/call (JSON-RPC)" --> MCP_A
    Orchestrator -. "tools/call (JSON-RPC)" .-> MCP_B

    %% Tenant A Tools
    MCP_A -- "execute_sql" --> DB_A
    MCP_A -- "search_docs" --> Chroma_A

    %% Tenant B Tools
    MCP_B -. "execute_sql" .-> DB_B
    MCP_B -. "search_docs" .-> Chroma_B

    %% Streaming Return Path
    DB_A -- "Results" --> MCP_A
    MCP_A -- "Observation" --> Orchestrator
    Orchestrator -- "data: {thought/obs}" --> UI
    UI -- "Real-time Update" --> User